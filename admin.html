<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Panel Auto ID</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
*{box-sizing:border-box}
body{margin:0;background:#0b0b0b;color:#f1f1f1;font-family:system-ui}
.page{max-width:480px;margin:auto;padding:16px}
input,textarea{width:100%;padding:12px;background:#161616;border:1px solid #222;color:#fff;border-radius:12px;margin-bottom:8px}
textarea{resize:none}
button{width:100%;padding:12px;background:linear-gradient(135deg,#ff0055,#ff3c7d);color:#fff;border:none;border-radius:14px;font-weight:600}
.small-btn{padding:8px;font-size:13px}
.btn-gray{background:#333}
.small{font-size:12px;color:#aaa;margin-bottom:6px}
.download-row{display:flex;gap:6px;margin-bottom:6px}
.download-row input{flex:1}
.download-row button{width:42px}
.preview-btn{background:#ff0055;padding:10px;border-radius:10px;margin-top:6px;text-align:center;font-weight:600}
</style>
</head>
<body>

<div class="page">
<h2>Admin Panel Part Video</h2>

<input id="titleInput" placeholder="Judul video">

<div class="small">Part Video</div>
<div id="downloads"></div>
<button class="small-btn btn-gray" onclick="addDownload()">➕ Tambah Part</button>

<br><br>
<button onclick="generate()">Generate</button>

<div class="small">Preview</div>
<div id="preview"></div>

<div class="small">JSON Output</div>
<textarea id="json" rows="8" readonly></textarea>

<div class="small">Link Stream</div>
<textarea id="link" rows="2" readonly></textarea>
</div>

<script>
const $ = id => document.getElementById(id);

function getNextPart(){
  return document.querySelectorAll('.download-row').length + 1;
}

function addDownload(label='', url=''){
  if(!label) label = 'Part ' + getNextPart();

  const d = document.createElement('div');
  d.className = 'download-row';
  d.innerHTML = `
    <input placeholder="Judul Part" value="${label}">
    <input placeholder="Link Video" value="${url}">
    <button onclick="this.parentNode.remove()">❌</button>`;
  $('downloads').appendChild(d);
}
addDownload();

function generate(){
  const title = $('titleInput').value.trim();
  if(!title) return alert("Isi judul");

  const parts=[];
  document.querySelectorAll('.download-row').forEach(r=>{
    if(r.children[1].value)
      parts.push({
        label: r.children[0].value,
        src: r.children[1].value
      });
  });

  if(!parts.length) return alert("Isi minimal 1 part");

  const id = 'vid_' + Date.now().toString(36);

  const data = {
    [id]: {
      title,
      src: parts[0].src,   // ⭐ INI KUNCI FIX NYA
      parts
    }
  };

  $('json').value = JSON.stringify(data,null,2);
  $('link').value = location.origin + '/?v=' + id;

  renderPreview(parts);
}

function renderPreview(parts){
  $('preview').innerHTML =
    parts.map(p=>`<div class="preview-btn">${p.label}</div>`).join('');
}
</script>
</body>
</html>
